RecReading=true;

campaignTrail_temp.global_parameter_json = [
    {
        "model": "campaign_trail.global_parameter",
        "pk": 1,
        "fields": {
            "vote_variable": 1.125,
            "max_swing": 0.12,
            "start_point": 0.94,
            "candidate_issue_weight": 10,
            "running_mate_issue_weight": 3,
            "issue_stance_1_max": -0.71,
            "issue_stance_2_max": -0.3,
            "issue_stance_3_max": -0.125,
            "issue_stance_4_max": 0.125,
            "issue_stance_5_max": 0.3,
            "issue_stance_6_max": 0.71,
            "global_variance": 0.01,
            "state_variance": 0.005,
            "question_count": 25,
            "default_map_color_hex": "#C9C9C9",
            "no_state_map_color_hex": "#999999"
        }
    }
]

campaignTrail_temp.election_json = [
    {
        "model": "campaign_trail.election",
        "pk": 9,
        "fields": {
            "year": 2000,
            "display_year": "2004",
            "summary": "<p>George Bush's narrow victory in 2000 set him up for a troubled and unpopular tenure. The September 11th attacks on the United States rallied popular support around him, but with the country fully engaged in the War on Terror, confidence in his leadership has begun to slip.</p><ul><li>George Bush must emphasize foreign policy and call upon his evangelical base, all while defending his domestic record.</li><li>John Kerry must carefully balance foreign policy while hammering in Bush's domestic failures.</li></ul>",
            "image_url": "https://itsastronomical.com/assets/2004/2004.png",
            "winning_electoral_vote_number": 270,
            "advisor_url": "https://itsastronomical.com/assets/2004/bushrove.png",
            "recommended_reading": "<div style='overflow-y:scroll;height:370px;color:black;'><h2 style='margin-top: 0.5em;'>The 2004 Presidential Election</h2><p style='padding:0px 65px'>Thanks for playing this one! </p><img src='https://itsastronomical.com/assets/2004/jibjab/bushending.jpg' height='170px'><h4>Sources</h4><h3>Election 2004: How Bush Won and What You Can Expect in the Future</h3><img src='https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1438706153i/98759.jpg' height='140px'><p>Newsweek's 2004 book was my primary source of information for the main ''campaign portion'' of the mod.<br>Other than that, I used <i>The New York Times</i>'s time machine, and the Internet Archive's Wayback Machine to access older materials. <br><br>Evan Thomas and the Staff of <i>Newsweek</i> - <a href='https://www.amazon.com/Election-2004-Bush-Expect-Future/dp/1586482939' target='_blank'>Election 2004: How Bush Won and What You Can Expect in the Future</a><br>US Election Atlas - <a href='https://uselectionatlas.org/RESULTS/national.php?year=2004' target='_blank'>2004 Presidential General Election Results</a><br><br><h4>Credits</h4><p>Coding done by ItsAstronomical.</p><p>Writing done by myself for the Bush side, and Jimbo writing the Kerry side. Halligan Elysium and Cecilla helped write endings.<p><p><a href='https://discord.gg/Qcmn5ZQJ5h' target='_blank'>Join this Discord Server to stay in the loop about all my upcoming projects!</a></p><img src='https://itsastronomical.com/assets/astroretro.gif' width='150px'></img><br><p>The VP skipper belongs to Decstar.  and of course...</p><h4>Special Thanks</h4><p>...thank you for playing!</p><p>- Astronomical</p><img src='https://itsastronomical.com/assets/astro_in_space_woooo.png' width='800px'></img><br><br><p>What are you doing here?! Go play the mod again!</p></div>",
            "has_visits": 1,
            "no_electoral_majority_image": "../static/images/2012-no-majority.jpg"
        }
    }
]

campaignTrail_temp.temp_election_list = [
    {
        "id": 9,
        "year": 2004,
        "is_premium": 0,
        "display_year": "2004"
    }
]

campaignTrail_temp.credits = "ItsAstronomical and Jimbo, with Halligan Elysium helping me write the endings.<br>Original 2004 mod by /u/Retsassin and /u/AMETSFAN"

if (localStorage.getItem("completedMode")) {
  campaignTrail_temp.credits = "ItsAstronomical and Jimbo.<br>Original 2004 mod by /u/Retsassin and /u/AMETSFAN<br><button onclick='window.toggleAssets()'>Toggle JibJab</button>"
}


campaignTrail_temp.modBoxTheme = {
     "header_image_url": "https://itsastronomical.com/assets/2004/2004final.gif",
     "header_color": "#BFE6FF",
     "header_text_color": "#FFFFFF",
     "description_text_color": "#000000",
     "description_background_color": "#ffffff",
     "main_color": "#74748b",
     "secondary_color": "#34343d",
     "ui_text_color": "#FFFFFF"
}

HistHexcolour=["#ab3a3a","#6d6dad","#b08293","#d3af41"];
HistName=[" George W. Bush"," John Kerry"," Ralph Nader"," Michael Badnarik/Others"];
HistEV=[286,252,0,0];
HistPV=["62,040,610","59,028,444","465,650","755,926"];
HistPVP=["50.7%","48.2%","0.3%","0.6%"];


campaignTrail_temp.candidate_json = [
    {
        "model": "campaign_trail.candidate",
        "pk": 77,
        "fields": {
            "first_name": "George W.",
            "last_name": "Bush",
            "election": 9,
            "party": "Republican",
            "state": "Texas",
            "priority": 1,
            "description": "<p>A dispute in Florida despite a popular vote loss ascended George Bush to the Presidency by the narrowest of margins, and much of his term was expected to be defined by this weak mandate, such as controversial proposals on education and Social Security. Of course, that all changed on September 11th, 2001.</p><p>Bush, who had campaigned in 2000 against ''nation-building'' operations has now led the country into two wars in Afghanistan and Iraq as part of what he dubs the ''War on Terror''. As 2004 approaches, it appears that the goodwill Americans gave him following 9/11 has begun to slip, with more and more voters concerned about the United States economy and voters begining to be swayed by the Kerry campaign. Despite this, Bush's largest advantage remains on foreign policy, and it may be that debate which will win him a true mandate to govern.</p>",
            "color_hex": "#ab3a3a",
            "secondary_color_hex": null,
            "is_active": 1,
            "image_url": "https://itsastronomical.com/assets/2004/dubya.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 78,
        "fields": {
            "first_name": "John",
            "last_name": "Kerry",
            "election": 9,
            "party": "Democratic",
            "state": "Massachusetts",
            "priority": 1,
            "description": "<p>Senator John Kerry had long been seen as one of the natural frontrunners, but had begun to flounder in 2003. It took aggressive strategies, including mortgaging his house, to revitalize his campaign and gain the momentum needed to win against Howard Dean and others. With the Democratic nomination having been locked up quickly, Kerry now pivots to the general election campaign.</p><p>Kerry is regarded has having the upper hand on the economy and healthcare issues, and his image as a war hero and three-time Purple Heart recipient is quite respected by voters. However, Bush clearly has the upper hand on foreign policy, and finding a good strategy to attack the President on the conflicts abroad will be tricky, especially with 9/11 still fresh in the minds of many voters.</p>",
            "color_hex": "#6d6dad",
            "secondary_color_hex": null,
            "is_active": 1,
            "image_url": "https://itsastronomical.com/assets/2004/kerry.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 79,
        "fields": {
            "first_name": "Ralph",
            "last_name": "Nader",
            "election": 9,
            "party": "Reform",
            "state": "Connecticut",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#b08293",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://www.jetsimon.com/public/candidateexample.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 80,
        "fields": {
            "first_name": "Michael",
            "last_name": "Badnarik",
            "election": 9,
            "party": "Libertarian",
            "state": "Texas",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#d3af41",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://www.jetsimon.com/public/candidateexample.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 177,
        "fields": {
            "first_name": "Dick",
            "last_name": "Cheney",
            "election": 9,
            "party": "Republican",
            "state": "Wyoming",
            "priority": 1,
            "description": "<p>NULL</p>",
            "color_hex": "#0000FF",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://itsastronomical.com/assets/2004/cheney.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "<p>As the current Vice President, Dick Cheney is the expected choice for the role of Bush's running mate. Cheney remains relatively popular with voters, and his experience as Secretary of Defense is a crucial asset for the Bush administration with a variety of conflicts abroad.</p><p>Nevertheless, Cheney's age means that it is unlikely he will run in the 2008 election, and it might be a worthwhile gamble for Bush to attempt to annoint a designated successor through the role of running mate - assuming he win, of course.</p>",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 278,
        "fields": {
            "first_name": "John",
            "last_name": "Edwards",
            "election": 9,
            "party": "Democratic",
            "state": "North Carolina",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#0000FF",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://itsastronomical.com/assets/2004/jedwards.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "<p>While Howard Dean may have gotten more attention, it was John Edwards who was runner up to Senator Kerry in the primaries. Edwards is an expected pick by the Kerry campaign, and he brings youth and energy to the ticket - at only 51 years of age.</p><p>Edwards' home state of North Carolina, where he may have the most positive impact, is unlikely to be competitive anyway. However, he could have a positive effect in the Midwestern states, where his populist style of politics is quite popular.</p>",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 279,
        "fields": {
            "first_name": "Dick",
            "last_name": "Gephardt",
            "election": 9,
            "party": "Democratic",
            "state": "Missouri",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#0000FF",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://itsastronomical.com/assets/2004/dickg.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "<p>Former House Minority Leader Dick Gephardt ran for the nomination against Kerry, but faltered in Iowa and dropped out the day after, giving him a crucial endorsement that helped him continue to gain momentum afterwards.</p><p>Missouri seems to be leaning Republican this year after Bush managed to win the state by a 3% margin in 2000. Putting the state back on the map could help shake up the race and negate potential losses in Wisconsin or Oregon. Gephardt's close ties to labor could help tilt the Midwest as a whole, but he is not the favorite of hardcore liberals.</p>",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 280,
        "fields": {
            "first_name": "Wesley",
            "last_name": "Clark",
            "election": 9,
            "party": "Democratic",
            "state": "Arkansas",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#0000FF",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://itsastronomical.com/assets/2004/wclark.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "<p>Former General Wesley Clark made a run for the Democratic nomination and was seen as a frontrunner for some time in 2003, but failed to break through. Still, his role as NATO's Supreme Allied Commander in Europe and status as an opponent of the War in Iraq make him a useful running mate, and he could absolutely help the campaign in states in the upper South such as Arkansas and Tennessee.</p><p>However, there are some questions about his departure from the military, and his record as a hawk within the Clinton administration might cause some issues for Kerry's campaign.</p>",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 178,
        "fields": {
            "first_name": "Bill",
            "last_name": "Frist",
            "election": 9,
            "party": "Republican",
            "state": "Tennessee",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#0000FF",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://itsastronomical.com/assets/2004/frist.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "<p>In the event that President Bush chooses to drop Vice President Cheney, Bill Frist seems like the natural successor for the role of running mate. As Senate Majority Leader, Frist would ensure loyalty within Republican ranks and commands respect in the chamber.</p><p>While Frist is far from unpopular, and may be a more effective campaigner, dropping Cheney might appear to be poor and erratic decision-making on Bush's part, especially with the War on Terror raging abroad.</p>",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 281,
        "fields": {
            "first_name": "John",
            "last_name": "McCain",
            "election": 9,
            "party": "Republican",
            "state": "Arizona",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#0000FF",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://itsastronomical.com/assets/2004/jmccain.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "<p><b>ALTERNATE HISTORY</b></p><p>Kerry has made numerous overtures to McCain to run a bipartisan unity ticket, offers which McCain is hesitant to accept, yet also hesitant to deny a request from a personal friend. McCain commands a high degree of popularity with self-described independent voters, and McCain has his own strong biography of service and sacrifice in Vietnam that pairs well with McCain.</p><p>Getting, and of course, keeping McCain on the ticket will be a monumental struggle. McCain will only join if issues arise with Bush, and if McCain can be convinced that he and Kerry can work out their political disagreements.</p>",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 1,
        "fields": {
            "first_name": "Howard",
            "last_name": "Dean",
            "election": 9,
            "party": "Democratic",
            "state": "Vermont",
            "priority": 1,
            "description": "tbd",
            "color_hex": "#6198a1",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://itsastronomical.com/assets/2004/dean.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "tbd",
            "candidate_score": 1,
            "running_mate": true
        }
    }
]

campaignTrail_temp.running_mate_json = [
    {
        "model": "campaign_trail.running_mate",
        "pk": 94294,
        "fields": {
            "candidate": 78,
            "running_mate": 278
        }
    },
    {
        "model": "campaign_trail.running_mate",
        "pk": 178075,
        "fields": {
            "candidate": 77,
            "running_mate": 177
        }
    },
    {
        "model": "campaign_trail.running_mate",
        "pk": 112331,
        "fields": {
            "candidate": 77,
            "running_mate": 178
        }
    },
    {
        "model": "campaign_trail.running_mate",
        "pk": 112332,
        "fields": {
            "candidate": 78,
            "running_mate": 280
        }
    },
    {
        "model": "campaign_trail.running_mate",
        "pk": 12243,
        "fields": {
            "candidate": 78,
            "running_mate": 279
        }
    }/*,
    {
        "model": "campaign_trail.running_mate",
        "pk": 112333,
        "fields": {
            "candidate": 78,
            "running_mate": 281
        }
    }
    */
]

campaignTrail_temp.opponents_default_json = [
    {
        "election": 9,
        "candidates": [
            77,
            78,
            79,
            80
        ]
    }
]

campaignTrail_temp.opponents_weighted_json = [
    {
        "election": 9,
        "candidates": [
            77,
            78,
            79,
            80
        ]
    }
]

jet_data = {
    "headerColor": "#700016",
    "windowColor": "#BFE6FF",
    "containerColor": "#FFFFFF",
    "innerWindowColor": "#E8FBFF",
    "bannerImageUrl": "https://jetsimon.com/public/placeholderbanner.png",
    "backgroundImageUrl": "https://coolbackgrounds.io/images/backgrounds/white/pure-white-background-85a2a7fd.jpg",
    "endingTextColor": "#000000",
    "customQuote": ""
}

document.head.innerHTML += `<style>

#achievement-box {
          position: fixed;
          bottom: 20px;
          right: 20px;
          background-color: #FFFFFF;
          color: white;
          padding: 15px 30px;
          border-radius: 8px;
          font-size: 18px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
          opacity: 0;
          transition: opacity 1s ease-in-out;
          z-index: 1000;
        }

        #achievement-box.visible {
          opacity: 1;
        }

#election_id_button,
#game_start {
  background: none !important;
  border: none !important;
  box-shadow: none !important;
  padding: 0 !important;
  width: 92px;
  height: 32px;
}

#election_id_button,
#game_start {
  width: 92px !important;
  height: 28px !important;

  background: url("https://itsastronomical.com/assets/2004/start.png") no-repeat center !important;
  background-size: 100% 100% !important;

  border: 0 !important;
  padding: 0 !important;
  box-shadow: none !important;

  /* hide the text cleanly */
  font-size: 0 !important;
  line-height: 0 !important;
  color: transparent !important;

  display: inline-block !important;
  vertical-align: middle !important;
}

/* kill any old pseudo-element rules you added earlier */
#election_id_button::after,
#game_start::after {
  content: none !important;
}
</style>`

const gameThemes = {
"Windows XP" : function() {
    document.body.background = "https://ia601007.us.archive.org/0/items/windows-xp-bliss-wallpaper/windows-xp-bliss-4k-lu-1920x1080.jpg"
    styling = document.createElement("style");
    document.head.appendChild(styling);          
    styling.innerHTML = `
    body {
        background-size: cover;
    }`
   document.head.innerHTML += `<link rel="stylesheet" href="https://unpkg.com/xp.css">`
    document.getElementById("header").src = "https://itsastronomical.com/assets/2004/bar.png";
    document.body.style.backgroundColor = "#FBFBFC";
    document.body.background = "";
    $(".container")[0].style.backgroundColor = "#fff";
    $(".container")[0].style.borderColor = "#166AEE";
    nct_stuff.themes[nct_stuff.selectedTheme].coloring_title = "#700016";
    corrr = '\n              <h2>THE CAMPAIGN TRAIL</h2>\n            '; 
    document.getElementsByClassName("game_header")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_title;
    nct_stuff.themes[nct_stuff.selectedTheme].coloring_window = "#FBFBFC";
    document.head.innerHTML += "<style>#results_container {color:#000000;} .inner_window_w_desc {background-color:#d3e5fa!important;}</style>";
    $("#game_window")[0].style.backgroundColor = "#d3e5fa";
    $(".footer")[0].style.color = "#000";
    $("#game_window")[0].style.backgroundImage = "url()"
    nct_stuff.themes[nct_stuff.selectedTheme].text_col = "black"
    document.body.background = "https://ia601007.us.archive.org/0/items/windows-xp-bliss-wallpaper/windows-xp-bliss-4k-lu-1920x1080.jpg"
    styling = document.createElement("style");
    document.head.appendChild(styling);          
    styling.innerHTML = `
    body {
        background-size: cover;
    }`
   document.head.innerHTML += `<link rel="stylesheet" href="https://unpkg.com/xp.css">`
    document.head.innerHTML += `<style>
    .container  {
      background-image: url(); 
      background-repeat: repeat; 
    }
    .game_header {
        background: linear-gradient(to bottom, #1263cc, #2173da, #418de9);
        height: 50px; 
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.1), 0 2px 5px rgba(0, 0, 0, 0.4);
    }
    .container  {
      background-image: url(); 
      background-repeat: repeat; 
    }
    #inner_window_2 {
      background-image: url(); 
      background-repeat: repeat; 
      height: 494px; 
    }
    #inner_window_3 {
      background-image: url(); 
      background-repeat: repeat; 
      height: 494px;
    }
    #inner_window_4 {
      background-image: url(); 
      background-repeat: repeat; 
      height: 494px;
      color: #000000;
    }
    </style>`
    document.head.innerHTML += `<style>
    #overall_details_container.done h4 {
        font-size: 14px !important;
    }
    
    #closeButton {
            background: none;
            border: none;
            outline: none;
            padding: 0;
            cursor: pointer;
        }

        /* Override xp.css focus and hover styles */
        #closeButton:focus,
        #closeButton:active,
        #closeButton:hover {
            outline: none;
            box-shadow: none;
            border: none;
        }

    h3 {
      font-size:1.17em!important;
    }
  
    label {
        font-size: 1em !important;
        font-family: Arial, "Helvetica Neue", Helvetica, sans-serif !important;
        display: inline-block !important;
        align-items: initial !important;
        gap: 0 !important;
    } 

  body {display:flex!important;}
  
  #game_window{max-width:1000px;}
    </style>`

},
"AmericanHistoryUSA" : function() {
    document.head.innerHTML += `<style>
    .container  {
      background-image: url(); 
      background-repeat: repeat; 
    }
    .game_header {
    background: #700016;
    box-shadow: none !important;
    height: auto !important;
    display: block !important;
    }
    #inner_window_2 {
      background-image: url(); 
      background-repeat: repeat; 
      height: 494px; 
    }
    #inner_window_3 {
      background-image: url(); 
      background-repeat: repeat; 
      height: 494px;
    }
    #inner_window_4 {
      background-image: url(); 
      background-repeat: repeat; 
      height: 494px;
      color: #000000;
    }
    </style>`;
    corrr = '\n              <h2>THE CAMPAIGN TRAIL</h2>\n            '; 
    document.body.style.backgroundColor = "#bfe6ff";
    $(".container")[0].style.backgroundColor = "#fff";
    nct_stuff.themes[nct_stuff.selectedTheme].coloring_title = "#700016";
    document.getElementsByClassName("game_header")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_title;
    nct_stuff.themes[nct_stuff.selectedTheme].coloring_window = "#e8fbff";
    document.head.innerHTML += "<style>#results_container {color:#000000;} .inner_window_w_desc {background-color:#E8FBFF!important;}</style>";
    $("#game_window")[0].style.backgroundColor = "#bfe6ff";
    $(".footer")[0].style.color = "#000";
    $("#game_window")[0].style.backgroundImage = "url()"
    nct_stuff.themes[nct_stuff.selectedTheme].text_col = "black"
}
}

// Replace old theme picker
const themePicker = document.getElementById("themePicker");
const newThemePicker = document.createElement("select");
newThemePicker.id = "themePicker";
newThemePicker.addEventListener("change", gameThemePicked);
let newInnerHTML = "";
for(theme in gameThemes) {
    newInnerHTML += `<option value="${theme}">${theme}</option>`;
}
newThemePicker.innerHTML = newInnerHTML;
themePicker.replaceWith(newThemePicker);

function gameThemePicked() {
    gameThemes[newThemePicker.value]();
}

gameThemePicked();

// Music Player

  // Select the node that will be observed for mutations
  const windowsAdvisorTargetNode = document.getElementById("game_window");
  
  // Options for the observer (which mutations to observe)
  const windowsAdvisorConfig = { attributes: true, childList: true, subtree: true };
  
  // Callback function to execute when mutations are observed
  const callback = (mutationList, observer) => {
      visitWindow = document.getElementsByClassName("overlay_window")[0];
  
      if(visitWindow == null || visitWindow.classList.contains("done")) {
          return;
      }
      visitWindow.classList.add("done");
      visitWindow.classList.add("window");
      let titleBar = visitWindow.querySelector("h3");
      titleBar.classList.add("title-bar");
      titleBar.classList.add("title-bar-text")
      titleBar.style.paddingLeft = "3px";
  };
  
  class Song {
    constructor(title, artist, coverLink, audioLink) {
      this.title = title;
      this.artist = artist;
      this.coverLink = coverLink;
      this.audioLink = audioLink;
    }
    getTitle() {
      return this.title;
    }
  
    getArtist() {
      return this.artist;
    }
  
    getCoverLink() {
      return this.coverLink;
    }
  
    getAudioLink() {
      return this.audioLink;
    }
  }
  
  class Playlist {
    constructor() {
      this.songs = [];
      this.currentSongIndex = 0;
    }
  
    addSong(song) {
      this.songs.push(song);
    }
  
    getCurrentSong() {
      return this.songs[this.currentSongIndex];
    }
  
    playNext() {
      this.currentSongIndex = (this.currentSongIndex + 1) % this.songs.length;
    }
  
    playPrevious() {
      this.currentSongIndex = (this.currentSongIndex - 1 + this.songs.length) % this.songs.length;
    }
  }
  window.Playlist=Playlist
  window.Song=Song
  
  function changePlaylist(newPlaylist) {
    playlist = newPlaylist;
    playlist.currentSongIndex = 0;
    updateUI(playlist);
    const audio = document.getElementById("audio");
    audio.src = playlist.getCurrentSong().audioLink;
    audio.play();
  }
  window.changePlaylist=changePlaylist
  
  function updateUI(playlist) {
      const currentSong = playlist.getCurrentSong();
      var player = document.getElementById("player");
      player.querySelector("#cover").src = currentSong.getCoverLink();
      player.querySelector("#title").textContent = currentSong.getTitle();
      player.querySelector("#artist").textContent = currentSong.getArtist();
  }
  
  window.updateUI=updateUI
  
  
  function setupMusicPlayer() {
    playlist = new Playlist();
    deanSoundtrack = new Playlist();
  
  
    const song1 = new Song(
      "Two Words",
      "Kanye West, Mos Def, The Boys Choir Of Harlem",
      "https://upload.wikimedia.org/wikipedia/en/a/a3/Kanyewest_collegedropout.jpg",
      "https://audio.jukehost.co.uk/SeyciEFDB7FW27mwoe6eUPNtLoEjTEDa"
    );
    
    const song2 = new Song(
      "Jesus of Suburbia",
      "Green Day",
      "https://upload.wikimedia.org/wikipedia/en/thumb/e/ed/Green_Day_-_American_Idiot_album_cover.png/220px-Green_Day_-_American_Idiot_album_cover.png",
      "https://audio.jukehost.co.uk/ie5hY1Mg2vFmhLCg6B4SCkLxR7qPJj8X"
    );
  
    const song3 = new Song(
      "Holiday / Boulevard of Broken Dreams",
      "Green Day",
      "https://upload.wikimedia.org/wikipedia/en/thumb/e/ed/Green_Day_-_American_Idiot_album_cover.png/220px-Green_Day_-_American_Idiot_album_cover.png",
      "https://audio.jukehost.co.uk/8CLWokDOaUI0nDFrFmDUMBYHCRHrnCDG"
    );




    const deansong1 = new Song(
      "The Middle",
      "Jimmy Eat World",
      "https://resources.tidal.com/images/8434cc6f/7ce9/4558/bea8/af00b34dce36/320x320.jpg",
      "https://audio.jukehost.co.uk/VLIEj9gbu4y1WBgJjMKkdlckXQzAQsb8"
    );

    const deansong2 = new Song(
      "Saddest Girl Story",
      "The Starting Line",
      "https://resources.tidal.com/images/89571243/7a8b/4a85/945b/ec723866e109/320x320.jpg",
      "https://audio.jukehost.co.uk/A2jyXHWjaFVimqsqdgldYnBokmEV2Aup"
    );

    const deansong3 = new Song(
      "The Boy Who Blocked His Own Shot",
      "Brand New",
      "https://resources.tidal.com/images/1c1ba9d5/f47c/417d/86d3/48d46dac02db/320x320.jpg",
      "https://audio.jukehost.co.uk/5tx0d7xnGrJw3T2ue4r451SLrRUphlBd"
    );

    const deansong4 = new Song(
      "War All The Time",
      "Thursday",
      "https://resources.tidal.com/images/2eb4dbc7/0f01/4d0c/ac73/c19691259eea/320x320.jpg",
      "https://audio.jukehost.co.uk/seThtysSBS6MsbfeUUNRuKlxAkR0GSlO"
    );
  
  
    playlist.addSong(song1);
    playlist.addSong(song2);
    playlist.addSong(song3);

    deanSoundtrack.addSong(deansong1);
    deanSoundtrack.addSong(deansong2);
    deanSoundtrack.addSong(deansong3);
    deanSoundtrack.addSong(deansong4);

    const playerContainer = document.createElement("div");
    playerContainer.id = "player";
  
   const displayBox = document.createElement("div");
  displayBox.id = "display-box";
  
  const coverElement = document.createElement("img");
  coverElement.id = "cover";
  displayBox.appendChild(coverElement);
  
  const infoContainer = document.createElement("div");
  infoContainer.id = "info-container";
  infoContainer.style.backgroundImage = "url('https://i.ibb.co/M73CBjW/overlay.png')";
  infoContainer.style.backgroundSize = "cover"; // Optional: adjust based on your needs
  infoContainer.style.color = "white"; // Set text color to white
  
  const songInfo = document.createElement("div");
  songInfo.id = "song-info";
  
  const titleElement = document.createElement("h3");
  titleElement.id = "title";
  titleElement.style.fontWeight = 'normal'; // Make it normal as per previous request
  songInfo.appendChild(titleElement);
  
  const artistElement = document.createElement("p");
  artistElement.id = "artist";
  songInfo.appendChild(artistElement);
  
  infoContainer.appendChild(songInfo);
  displayBox.appendChild(infoContainer);
  
  playerContainer.appendChild(displayBox);
  
  const controlsContainer = document.createElement("div");
  controlsContainer.id = "controls-container";
  
  const controls = document.createElement("div");
  controls.id = "controls";
  
  const prevButton = document.createElement("img");
  prevButton.id = "prevButton";
  prevButton.src = "https://i.ibb.co/gMyNq5T/back.png";
  prevButton.alt = "Previous";
  controls.appendChild(prevButton);
  
  const playPauseButton = document.createElement("img");
  playPauseButton.id = "playPauseButton";
  playPauseButton.src = "https://i.ibb.co/5TwzzWN/pause.png"; // Set the default play image
  playPauseButton.alt = "Play/Pause";
  controls.appendChild(playPauseButton);
  
  const nextButton = document.createElement("img");
  nextButton.id = "nextButton";
  nextButton.src = "https://i.ibb.co/5Rx0cYt/forward.png";
  nextButton.alt = "Next";
  controls.appendChild(nextButton);
  
  controlsContainer.appendChild(controls);
  
  playPauseButton.addEventListener("click", function () {
    const audio = document.getElementById("audio");
    if (audio.paused) {
      audio.play();
      playPauseButton.src = "https://i.ibb.co/5TwzzWN/pause.png"; // Set the pause image
    } else {
      audio.pause();
      playPauseButton.src = "https://i.ibb.co/G5TsX12/play.png"; // Set the play image
    }
  });
  
  nextButton.addEventListener("click", function () {
    playlist.playNext();
    updateUI(playlist);
    const audio = document.getElementById("audio");
    audio.src = playlist.getCurrentSong().audioLink;
    audio.play();
  });
  
  prevButton.addEventListener("click", function () {
    playlist.playPrevious();
    updateUI(playlist);
    const audio = document.getElementById("audio");
    audio.src = playlist.getCurrentSong().audioLink;
    audio.play();
  });
  
    const progressBarContainer = document.createElement("div");
    progressBarContainer.id = "progress-bar-container";
  
    const progressBar = document.createElement("progress");
    progressBar.type = "range";
    progressBar.id = "progress-bar";
    progressBar.value = "0";
    progressBar.max = "100";
  
  
    progressBarContainer.appendChild(progressBar);
    controlsContainer.appendChild(progressBarContainer);
    playerContainer.appendChild(controlsContainer);
  
   const volumeContainer = document.createElement("div");
    volumeContainer.id = "volume-container";
  
  const volumeLabel = document.createElement("img");
  volumeLabel.src = "https://i.ibb.co/9Gkg5Qp/volume.png";
  volumeLabel.alt = "Volume";
  volumeContainer.appendChild(volumeLabel);
  
    const volumeSliderContainer = document.createElement("div");
    volumeSliderContainer.classList.add("is-vertical");
    volumeSliderContainer.style.marginLeft = "23%";
    volumeSliderContainer.style.height = "126px";
  
    const volumeSlider = document.createElement("input");
    volumeSlider.type = "range";
    volumeSlider.id = "volumeSlider";
    volumeSlider.min = 0;
    volumeSlider.max = 9;
    volumeSlider.step = 1;
    volumeSlider.value = 1; // Initial volume
  
    volumeSliderContainer.appendChild(volumeSlider);
  
    const volumeDisplay = document.createElement("span");
    volumeDisplay.id = "volume-display";
    volumeDisplay.style.fontWeight = 'bold'; 
    volumeDisplay.style.display = 'none';
    volumeDisplay.textContent = "1";
  
    volumeContainer.appendChild(volumeSliderContainer);
    volumeContainer.appendChild(volumeDisplay);
  
    playerContainer.appendChild(volumeContainer);
  
    gameWindow_player.insertAdjacentElement("afterend", playerContainer);
  
  
    function updateProgressBar() {
      const audio = document.getElementById("audio");
      const progress = (audio.currentTime / audio.duration) * 100;
      try{progressBar.value = progress}
    catch{}
    }
  
   
    progressBar.addEventListener("input", function () {
      const audio = document.getElementById("audio");
      const seekTime = (progressBar.value / 100) * audio.duration;
      audio.currentTime = seekTime;
    });
  
    const audio = document.createElement("audio");
    audio.id = "audio";
    audio.src = playlist.getCurrentSong().audioLink;
    audio.volume = 1/9;
  
    audio.addEventListener("timeupdate", updateProgressBar);
    audio.addEventListener("ended", function () {
      // Play the next song when the current song ends
      playlist.playNext();
      updateUI(playlist);
      audio.src = playlist.getCurrentSong().audioLink;
      audio.play();
    });
  
      let currentVolume = 1; // Initial volume
  
    volumeSlider.addEventListener("input", function () {
      currentVolume = parseInt(volumeSlider.value, 10);
      updateVolumeDisplay();
      updateAudioVolume();
    });
  
    function updateVolumeDisplay() {
      volumeDisplay.textContent = currentVolume;
    }
  
     function updateAudioVolume() {
      const audio = document.getElementById("audio");
      audio.volume = currentVolume / 9; // Set volume between 0 and 1
    }
  
    document.body.appendChild(audio);
    audio.play();
  
    // Update the UI when the page loads
    updateUI(playlist);
  }
  
  const style = document.createElement("style");
  style.textContent = `
  #player {
      border: 3px solid #C9C9C9; /* Add your desired border style */
      display: flex;
      flex-direction: row;
    height:191px;
      background-Image: url("https://i.ibb.co/dKL29kY/background.png");
    }
  
    #display-box {
      display: flex;
      align-items: center;
      width: 50%;
    }
  
    #cover {
      width: 176px;
    height:176px;
    }
  
    #info-container {
      display: flex;
      flex-direction: row;
      height:178px;
    width:127px;
    margin-top: 3px;
    }
  
    #song-info {
      width: 100%;
    padding:5px;
    }
  
    #controls-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 10px;
      width:100%;
    padding-top:15px;
  
    }
    .is-vertical #volumeSlider {
    width: 125px;
  }
  
    #controls {
      display: flex;
      flex-direction: row;
      justify-content: center;
      width: 80%;
    }
  
    #progress-bar-container {
      width: 100%;
    }
  
    #progress-bar {
      width: 80%;
      margin: auto;
      display: flex;
      margin-Top: 20px;
    }
    
  `;
  
  document.head.appendChild(style);
  
  const gameWindow_player = document.getElementById("game_window");
  //use this function directly or put it in an event listener to start the music on the press of a certain button
  setupMusicPlayer();


let z = new MutationObserver((mutationsList, observer) => {
    $('#candidate_id_button').click(function () {
        $("#running_mate_id_button").click();
    })

    $('#opponent_selection_id_back').click(function () {
        $("#running_mate_id_back").click();
    })

    $('#opponent_selection_id_button').click(function () {
        observer.disconnect();
    })
});

z.observe(document, { subtree: true, childList: true });

if (e.CTS) {
  document.addEventListener('click', (event) => {
    const { target } = event;
    if (target.matches('#candidate_id_button'))
      document.getElementById('running_mate_id_button')?.click();
    else if (target.matches('#opponent_selection_id_back'))
      document.getElementById('running_mate_id_back')?.click();
  });
}

const startScreenUpdater = setInterval(function() {
    const goBackButton = document.getElementById("candidate_id_back");
    const candidateButton = document.getElementById("candidate_id_button");
    const runningMateButton = document.getElementById("running_mate_id_button");
    const finalScreenBB = document.getElementById("opponent_selection_id_back");
    const finalScreenID = document.getElementById("opponent_selection_id_button");
    
    /* if((candidateButton || c != 0)&& !runningMateButton){ // change theme on candidate viewing
        var c = document.getElementById("candidate_id")?.value ?? -1;
        if(c == 24 && !(candidateButton) && !(runningMateButton)) {
            goBackButton.click();
            const initContinue = document.getElementById("election_id_button");
            initContinue.click();
        }
    } */
    
   if(!candidateButton && runningMateButton) { 
        runningMateButton.click();
        const finalBack = document.getElementById("opponent_selection_id_back");
        finalBack.remove();
        observer.disconnect()
    }

    if(finalScreenID && finalScreenBB) { // delete back button and delete the interval
        finalScreenBB.remove();
        clearInterval(startScreenUpdater);
    }
}, 1);

var done = false;
var done2 = false;
                      
const windowCheck = localStorage.getItem('astroWindow');

function addColor() {
    var difficultyDiv = document.getElementById("difficulty_level");
    if (difficultyDiv && done != true && !document.getElementById("bunnyhopDropdown")) {
              done = true;
              console.log("HQ button")
              campaignTrail_temp.bunnyhop = false;
              done2 = true;
            var options = ["Yes", "No"];
            var dropdown = document.createElement("select");
            dropdown.id = "bunnyhopDropdown";
            for (var i = 0; i < options.length; i++) {
              var opt = document.createElement("option");
              opt.textContent = options[i];
              dropdown.options.add(opt);
            }
            var form = document.createElement("form");
            form.name = "bunnyhopForm";
            var header = document.createElement("h3");
            header.textContent = "Enable Draggable Campaign HQ?";
            form.appendChild(header);
            form.appendChild(dropdown);
            difficultyDiv.appendChild(form);
              if (windowCheck == "true") {
                dropdown.value = "Yes";
              }
              else {
                dropdown.value = "No";
              }
            dropdown.addEventListener("change", function() {

                if (dropdown.value == "Yes") {
                    console.log("enabling window")
                    campaignTrail_temp.window = true;
                    localStorage.setItem("astroWindow", "true")
                }
                else{          
                    console.log("disabling window")
                    campaignTrail_temp.window = false;
                    localStorage.setItem("astroWindow", "false")
                }
            });
  
              var difficultyForm = document.querySelector('form[name="difficulty_level_selection"]');
              var difficultyHeader = difficultyForm.querySelector('h3');
              difficultyHeader.textContent = "Select campaign difficulty:";
  
              var forms = document.querySelectorAll("#difficulty_level form");
              for (var i = 0; i < forms.length; i++) {
                forms[i].style.display = "inline-block";
                forms[i].style.paddingLeft = "10px"; // adjust the value as needed
                forms[i].style.paddingRight = "10px"; // adjust the value as needed
              }
  
    }
}

// the wrapper here is the same that makes sure your music player doesn't exist twice basically
if(!campaignTrail_temp.observer){
  
      campaignTrail_temp.observer = true
  
      // Define the MutationObserver
      let masterObserver = new MutationObserver(masterFunction);
      function masterFunction() {
          masterObserver.disconnect();
  
          addColor();
  
          masterObserver.observe(document.body, { childList: true, subtree: true });
      }
  
      // Start observing the document with the master observer
      masterObserver.observe(document.body, { childList: true, subtree: true });
}
hasMusic = false;
e = campaignTrail_temp;
e.collect_results=true;
nct_stuff.themes[nct_stuff.selectedTheme].coloring_title = "#E67C4C";

nct_stuff.themes[nct_stuff.selectedTheme].coloring_window = "#E6AB8F";

document.getElementsByClassName("game_header")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_title;

$("#game_window")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_window;

$(".container")[0].style.backgroundColor = "#EB2A40";

document.getElementById("header").src = "https://files.catbox.moe/txpjdj.png";

document.body.background = "https://i.imgur.com/vTsxreG.png";

function replaceFurtherReading() {
  // Get the button element
  try {
    const recReadingButton = document.getElementById('recommended_reading_button');

    // Add a click event listener to the button
    recReadingButton.addEventListener('click', function() {
      const mainContent = document.getElementById("main_content_area_reading");
      if (mainContent) {
        mainContent.innerHTML = `
          <h3 class="results_tab_header">Further Reading</h3>
          <div id="recommended_reading_box" style="overflow-y:scroll;height:357.133px;font-size:1em;text-align: left;">
            <h1>Thank you for playing 2016 New Day!</h1>
            <p><a href="https://www.cnn.com/ALLPOLITICS/stories/1999/07/14/president.2000/kasich/">https://www.cnn.com/ALLPOLITICS/stories/1999/07/14/president.2000/kasich/</a>
			<p><a href="https://www.amazon.com/Romney-Reckoning-McKay-Coppins/dp/1982196203">Romney: A Reckoning</a>
			<p><a href="https://www.cnn.com/2016/05/04/politics/john-kasich-drops-out/index.html">https://www.cnn.com/2016/05/04/politics/john-kasich-drops-out/index.html</a>
			<p><a href="https://www.gq.com/story/john-kasich-loves-fall-out-boy-and-linkin-park">https://www.gq.com/story/john-kasich-loves-fall-out-boy-and-linkin-park</a>
			<p><a href="https://www.nytimes.com/2016/03/21/magazine/why-the-republican-establishment-doesnt-like-john-kasich.html">https://www.nytimes.com/2016/03/21/magazine/why-the-republican-establishment-doesnt-like-john-kasich.html</a>
			<p><a href="https://en.wikipedia.org/wiki/John_Kasich_2016_presidential_campaign">https://en.wikipedia.org/wiki/John_Kasich_2016_presidential_campaign</a>
			<p><a href="https://www.c-span.org/video/?404529-1/presidential-candidate-john-kasich-primary-night-speech">https://www.c-span.org/video/?404529-1/presidential-candidate-john-kasich-primary-night-speech</a>
			<p><a href="https://www.politico.com/story/2016/02/john-kasich-first-100-days-219324">https://www.politico.com/story/2016/02/john-kasich-first-100-days-219324</a>
			<p><a href="https://www.huffpost.com/entry/john-kasich-new-hampshire-primary_n_56ba9c27e4b0b40245c4a1aa">https://www.huffpost.com/entry/john-kasich-new-hampshire-primary_n_56ba9c27e4b0b40245c4a1aa</a>
			<p>and some more articles that I can\'t find or don\'t remember</p></p></p></p></p></p></p></p></p></p>
			
			<h1>Canon map</h1>
			<img src="https://i.imgur.com/xGAYd5m.png" width=800>
          </div>`;
      }
    });
  } catch {}
}
window.setInterval(replaceFurtherReading,200)

e.election_json = [{"model":"campaign_trail.election","pk":20,"fields":{
"year":2016,
"summary":"<p><li>John Kasich has won the Republican nomination, working with Ted Cruz to deny it to Donald Trump. He is expected to lose in a landslide as a result of vote splitting by Trump\’s vengeful campaign.</li><li>Bernie Sanders had a shocking victory over establishment candidate Hillary Clinton. He is widely anticipated to win at present, despite generally being perceived as very radical.</li><li>Donald Trump hopes to deadlock the election, gaining concessions in the process. Maybe he can build up enough momentum for another run in 2020?</li></p>","image_url":"https://files.catbox.moe/ayl6t4.png","winning_electoral_vote_number":270,"advisor_url":"https://files.catbox.moe/5h6j3l.png",
"recommended_reading":"<ul>\n<li><a href=https://www.chicagotribune.com/opinion/editorials/ct-edit-chicago-tribune-biden-endorsement-20200925-lnyxsb5qvrftnjjmj3rnzj33jy-story.html>Our Case For Joe Biden</a></li>\n<li><a href=https://nationalinterest.org/feature/case-trump-166808>The Case For Trump</a></li>\n<li><a href=https://www.npr.org/2020/11/18/935730100/how-biden-won-ramping-up-the-base-and-expanding-margins-in-the-suburbs>How Biden Won: Ramping Up The Base And Expanding Margins In The Suburbs</a></li>\n<li><a href=https://www.prospectmagazine.co.uk/politics/donald-trump-joe-biden-us-election-almost-win-votes-concede>Why Did Trump Almost Win?</a></li>\n<li><a href=https://www.hoover.org/research/no-evidence-voter-fraud-guide-statistical-claims-about-2020-election>No Evidence For Voter Fraud: A Guide To Statistical Claims About The 2020 Election</a></li>\n</ul>",
"has_visits":1,
"no_electoral_majority_image":"../static/images/2012-no-majority.jpg"}}];e.temp_election_list = [{"id":20,"year":2016,"is_premium":0,"display_year":"2016NewDay"}];e.credits = "Max, with the banner by count_nathan";
e.global_parameter_json = [{
"model":"campaign_trail.global_parameter","pk":1,"fields":{"vote_variable":1.125,"max_swing":0.12,"start_point":0.94,"candidate_issue_weight":10,"running_mate_issue_weight":3,"issue_stance_1_max":-0.71,"issue_stance_2_max":-0.3,"issue_stance_3_max":-0.125,"issue_stance_4_max":0.125,"issue_stance_5_max":0.3,"issue_stance_6_max":0.71,
"global_variance":0.004,"state_variance":0.0025,
"question_count":25,"default_map_color_hex":"#C9C9C9","no_state_map_color_hex":"#999999"}}];
e.candidate_json = [{"model":"campaign_trail.candidate","pk":200,"fields":{"first_name":"John","last_name":"Kasich","election":20,"party":"Republican","state":"Ohio","priority":1,
"description":"John Kasich, more than any politician in the Republican Party today, represents the old compassionate conservatism that brought George Bush victory. He ran and lost on that platform in 2000, and now he’s hoping that he’ll be able to end eight years of Democratic control of the White House with a platform of light, hope, and moderation.<br><br>He’s represented Ohio as State Senator, Governor, and most famously as Representative - he drafted the first balanced budget since Reagan’s time, after all! And he just won a landslide in Ohio, surely he can repeat that feat at the federal level?<br><br>Well, that’s looking tough. He was only able to secure the nomination through a backroom deal with Ted Cruz, and as a result businessman Donald Trump has declared a third party bid. As a result, Kasich is under siege from populism of both the left and right. But he’ll prevail. He has to.",
"color_hex":"#ab2d24","secondary_color_hex":null,"is_active":1,"image_url":"https://i.imgur.com/ZxZ382f.png","electoral_victory_message":"<h3>REAL PATRIOT DUMMY EXAMPLE SWEEPS</h3>","electoral_loss_message":"<h3>Fake News?</h3>","no_electoral_majority_message":"<h3>DUMMY EXAMPLE RETURNS TO HELL</h3>","description_as_running_mate":null,"candidate_score":1,"running_mate":false,"scrollable":false}},{"model":"campaign_trail.candidate","pk":201,"fields":{"first_name":"Bernie","last_name":"Sanders","election":20,"party":"Democratic","state":"Vermont","priority":1,"description":"N/A","color_hex":"#5c9ee0","secondary_color_hex":null,"is_active":0,"image_url":"https://i.imgur.com/gHjr02p.png","electoral_victory_message":"<h3>REAL PATRIOT DUMMY EXAMPLE SWEEPS</h3>","electoral_loss_message":"<h3>Fake News?</h3>","no_electoral_majority_message":"<h3>DUMMY EXAMPLE RETURNS TO HELL</h3>","description_as_running_mate":null,"candidate_score":1,"running_mate":false,"scrollable":false}},{"model":"campaign_trail.candidate","pk":1003,"fields":{"first_name":"Ted","last_name":"Cruz","election":20,"party":"Republican","state":"Texas","priority":1,"description":"Ted Cruz. You two made a deal, and that's why you're the Republican nominee. After Rubio dropped out, it was just you two together, united against Trump. Following your victory in New Hampshire, and the clearing of candidates like Rubio and Bush after their poor performances, you and Cruz were able to blunt Trump's momentum, and while he did better than either of you personally, together you were able to beat him.<br><br>But Cruz's support came at a cost. In exchange for supporting you for the Presidential nomination, he expects your support as the Vice Presidential Nominee. If it is not forthcoming, he will be rather displeased. You may be able to mollify him with a position like Secretary of State, but it may still harm your cause.<br><br>Texas is unlikely to be competitive, but Cruz showed in the primaries that he has appeal outside his home state. He's a strong pick, and most of your advisors think you'd be crazy to pick anyone else.","color_hex":"#0000ff","secondary_color_hex":null,"is_active":0,"image_url":"https://i.imgur.com/PXzlgy9.png","electoral_victory_message":"<h3>REAL PATRIOT DUMMY EXAMPLE SWEEPS</h3>","electoral_loss_message":"<h3>Fake News?</h3>","no_electoral_majority_message":"<h3>DUMMY EXAMPLE RETURNS TO HELL</h3>","description_as_running_mate":"You and Cruz made a deal, that's why you're the Republican nominee. After Rubio dropped out, it was just you and him, united against Trump. Following your victory in New Hampshire, and the clearing of candidates like Rubio and Bush after their poor performances, you and Cruz were able to blunt Trump's momentum, and while he came before either of you personally, together you were able to beat him.<br><br>But Cruz's support came at a cost. In exchange for supporting you for the Presidential nomination, he expects your support as the Vice Presidential Nominee. If it is not forthcoming, he will be rather displeased. You may be able to mollify him with a position like Secretary of State, however.<br><br>Texas is unlikely to be a competitive state, but Cruz showed in the primaries that he has appeal outside his home state. He's a strong pick, and you don\'t have many other options - a Cruz defection would end your chances at the Presidency before the race even kicks off.","candidate_score":1,"running_mate":true,"scrollable":false,"partner":"0"}},{"model":"campaign_trail.candidate","pk":202,"fields":{"first_name":"Donald","last_name":"Trump","election":20,"party":"Independent","state":"Florida","priority":1,"description":"N/A","color_hex":"#eca713","secondary_color_hex":null,"is_active":0,"image_url":"https://cdn.discordapp.com/attachments/746493275929706569/1145860636077740164/trump_cropped.png","electoral_victory_message":"<h3>REAL PATRIOT DUMMY EXAMPLE SWEEPS</h3>","electoral_loss_message":"<h3>Fake News?</h3>","no_electoral_majority_message":"<h3>DUMMY EXAMPLE RETURNS TO HELL</h3>","description_as_running_mate":null,"candidate_score":1,"running_mate":false,"scrollable":false}},{"model":"campaign_trail.candidate","pk":203,"fields":{"first_name":"","last_name":"Other Parties","election":20,"party":"Libertarian/Green","state":"Various","priority":1,"description":"Johnson and Stein and the like","color_hex":"#d616e3","secondary_color_hex":null,"is_active":0,"image_url":"../static/images/barack-obama-2012.jpg","electoral_victory_message":"<h3>REAL PATRIOT DUMMY EXAMPLE SWEEPS</h3>","electoral_loss_message":"<h3>Fake News?</h3>","no_electoral_majority_message":"<h3>DUMMY EXAMPLE RETURNS TO HELL</h3>","description_as_running_mate":null,"candidate_score":1,"running_mate":false,"scrollable":false}}];e.running_mate_json = [{"model":"campaign_trail.running_mate","pk":2001,"fields":{"candidate":200,"running_mate":1003}}];

var changeGameDisp = (hide) => {
  disp = "";
  if (hide) {
    disp = "none";
  }
  document.getElementsByClassName("inner_window_w_desc")[0].style.display = disp
};

e.creditsPage = () => {
  credits_html = `
    <h3>SPECIAL THANKS TO:</h3>
    <p><font color='#FF6A00'>Nina</font></p>
    <h3><font color='#BB9CDA'>CREDIT TO:</font></h3>
    <p><font color='#cc99ff'>2000N and 2021DE and 2008SB and 2016Gary</font>
	<p><font color='#BB9CDA'>2000N for the soundtrack system and the credits button and inspiration</font>
	<p><font color='#cc99ff'>2021DE for a lot of the CYOA, especially the Trump dynamic stuff, and other stuff too</font>
	<p><font color='#BB9CDA'>2016 Gary Johnson for the polling stuff and 1956 Red for the credits stuff, which is super awesome!!!</font></p>
	<p><font color='#cc99ff'>2008 Spongebob because I stole this Credits page from there. Also generally because the creators are cool people!</font></p></p></p></p>
    <h3>CODING:</h3>
    <p><font color='#CD59FF'>Max</font></p>
    <h3>WRITING:</h3>
    <p><font color='#84FF84'>Max</font></p>
	<h3>BANNER AND START IMAGE</h3>
    <p><font color='#B87333'>count_nathan</font></p> <!-- custom -->
    <h3>PLAYTESTING</h3>
    <p><font color='#ee0b29'>Kostas</font></p> <!-- custom -->
    <p><font color='#cc95b9'>CatBoxXD</font></p> <!-- custom -->
    <p><font color='#B87333'>count_nathan</font></p> <!-- custom -->
    <p><font color='#de0b19'>MassachussetsForStockdale</font></p> <!-- custom -->
    <p><font color='#FF00DC'>Padreppio</font></p>
	<p><font color='#FFC0CB'>Shae the Udmurt</font></p> <!-- custom -->
    <h3>HELP OF VARIOUS SORTS</h3>
	<p><font color='#FF6A00'>Nina</font></p>
	<p><font color='#800080'>Justanormalguyok</font></p> <!-- custom -->
	<p><font color='#FFFFFF'>BasedTejano</font></p> <!-- custom -->
	<p><font color='#ff51d0'>MortifiedNassau</font></p> <!-- custom -->
	<p><font color='#45b6fe'>Dechinburg</font></p> <!-- custom -->
    <p><font color='#de0b19'>MassachussetsForStockdale</font></p> <!-- custom -->
    <p><font color='FAA61A'>Killeritch</font></p> <!-- custom -->
	<p><font color='#ff748c'>Diamondy</font></p> <!-- custom -->
    <h3>A BUNCH OF THE PORTRAITS</h3>
    <p><font color='#BA3F0F'>Answerisme</font></p>
    <h3>MUSIC SELECTION:</h3>
    <p><font color='#EACA7D'>Fmr. Governor John Kasich and his campaign, with curation by Max</font></p>
    <h3>NOTE FROM THE CREATOR:</h3>
    <p><font color='#E0C8FF'>Hi, I\'m Max! I hope you enjoy this mod! My goal here was to create a mod with fun and varied gameplay using an interesting and reasonably plausible scenario which deviated from what was the norm at the time I started it, big narrative heavy stuff. That type of mod is fun, but personally I\'m a big sucker for these very gameplay oriented mods - so I made my own. It's got pretty fun gameplay, a decent bit of CYOA, and a whole bunch of endings. I hope you enjoy, feel free to message me on discord (max_6711) with thoughts or feedback or whatever. Also, I am currently working on the Trump side, and I will probably make the 2020 sequel to this at some point. But I am fairly unlikely to ever make the Bernie side, just because it\'s too similar to the multiple other Bernie mods out there. I don\'t think I could ever do it better than 2016 4way redux, for instance. - Max</font></p>
  `
  changeGameDisp(true);
  var spacer = document.createElement("sisar_gorcia_will_travel_back_in_time_and_win_the_2020_mod_just_you_wait");
  spacer.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
  document
    .getElementsByClassName("inner_window_w_desc")[0]
    .children[1].appendChild(spacer);
    changeGameDisp(true);
    var menuHeader = document.createElement("div");
    menuHeader.classList.add("inner_window_front");
    menuHeader.innerHTML = `<h1 style='font-family: "Times New Roman";'><font color='#FFFFFF'>CREDITS</font></h1>`;
    menuHeader.id = "SOTUheader";
    menuHeader.style = "height: 50px;background-color:#5F2126";
    var newMenu = document.createElement("div");
    newMenu.classList.add("inner_window_front");
    newMenu.id = "SOTUmenu";
    newMenu.style = `height:260px;background-color:#2d2d2d;color:white;overflow-y: scroll;`;

    newMenu.innerHTML = credits_html;
    let z = document.getElementById("game_window");
    var backButton = document.createElement("button");
    backButton.style =
      "position: relative; bottom: -13px; left: -380px; width: 150px; height: 80px;font-size:40px;padding-top:5px;padding-left:8px";
    backButton.id = "backSOTUBtn";
    backButton.innerHTML = `<b>BACK</b>`;
    backButton.onclick = function () {
      document.getElementById("SOTUheader").remove();
      document.getElementById("SOTUmenu").remove();
      document.getElementById("backSOTUBtn").remove();
      changeGameDisp(false);
    };
    z.appendChild(menuHeader);
    z.appendChild(newMenu);
    z.appendChild(backButton);

}

e.credits = "<button onclick='e.creditsPage()'>Max</button>"

  
quotes = [
    "\"If I am President, I am going to, once and for all, reunite Pink Floyd.\" - John Kasich",
    "\"This business of compassionate conservatism, I wish I'd thought it up\" - John Kasich",
    "\"If you’re not on the bus, we’ll run over you with the bus. And I’m not kidding.\" - John Kasich",
	"\"I just went to a wedding of a friend of mine who happens to be gay.\" - John Kasich",
	"\"My own view on guns is, everything being equal, states should make those decisions.\” - Bernie Sanders",
	"\"Super PACs funded by billionaires buy elections.\" - Bernie Sanders",
	"\"The American people are tired of women.\" - Bernie Sanders",
	"\"The beauty of me is that I\'m very rich.\" - Donald Trump",
	"\"I fully understand why her former husband left her for a man- he made a good decision.\" - Donald Trump",
	"\"When Mexico sends its people, they\'re not sending the best.\" - Donald Trump"
]

customquote = quotes[Math.floor((Math.random() * quotes.length))]

corrr="\n<h2>NEW CAMPAIGN TRAIL</h2><font id='wittyquote' size='4' color='white'><em>" + customquote + "</em></font>"

$("#game_start").click((event) => {
    event.preventDefault();
    musicMode()  
  })
  
  // MUSIC MODE
  
  musicMode = () => {
    // Initialise custom music
  
    $("#music_player")[0].children[0].style.display = "none"
    $("#music_player")[0].children[1].style.display = "none"
  
    document.getElementById("modLoadReveal").style.display = "none"
    document.getElementById("modloaddiv").style.display = "none"
  
    musicBox = document.getElementById("music_player")
    musicBox.style.display = ""
  
    var trackSel;
    e = campaignTrail_temp
    e.selectedSoundtrack = 0
  
    toTime = (seconds) => {
        var date = new Date(null);
        date.setSeconds(seconds);
        return date.toISOString().substr(11, 8);
    }
  
    generateTime = () => {
        // Get the audio element
        var audio = document.getElementById("campaigntrailmusic");
  
        timeTracker = document.createElement("div");
        timeTracker.style = `
  text-align:left;
  border-style:solid;
  border-width:3px;
  height:150px;
  width:200px;
  background-color:#999999;
  float:right;
  padding: 10px;
  `
        $("#trackSelParent")[0].prepend(timeTracker);
        $("#trackSelParent")[0].prepend(document.createElement("br"));
  
        // Create a new element to display the current position of the audio
        var positionDisplay = document.createElement("gg");
        positionDisplay.id = "position-display";
  
        // Create a new slider element to change the time
        var timeSlider = document.createElement("input");
        timeSlider.type = "range";
        timeSlider.min = 0;
        timeSlider.max = 1;
        timeSlider.step = 0.001;
        timeSlider.value = 0;
        timeSlider.style.width = "200px";
        timeSlider.id = "time-slider";
  
        var pausePlay = document.createElement("button");
        pausePlay.id = "position-display";
        pausePlay.innerHTML = "<b>Pause</b>"
        pausePlay.style.width = "100%";
  
  
        pausePlay.addEventListener("click", event => {
            event.preventDefault();
            updatePositionDisplay();
            let audio = document.getElementById("campaigntrailmusic");
            if (audio.paused) {
                audio.play();
                event.target.innerHTML = "<b>Pause</b>";
                return;
            }
            audio.pause();
            event.target.innerHTML = "<b>Play</b>";
            return;
        })
  
        var volumeLabel = document.createElement("gg");
        volumeLabel.id = "volume-label";
        volumeLabel.innerHTML = "<br><b>Volume: </b>"
  
        var volumeSlider = document.createElement("input");
        volumeSlider.type = "range";
        volumeSlider.min = 0;
        volumeSlider.max = 1;
        volumeSlider.step = 0.001;
        volumeSlider.value = 0;
        volumeSlider.style.width = "200px";
        volumeSlider.id = "volume-slider";
  
        volumeSlider.value = audio.volume;
  
        timeTracker.appendChild(pausePlay);
        timeTracker.appendChild(document.createElement("br"));
        timeTracker.appendChild(document.createElement("br"));
        timeTracker.appendChild(positionDisplay);
        timeTracker.appendChild(timeSlider);
        timeTracker.appendChild(volumeLabel);
        timeTracker.appendChild(volumeSlider);
  
        updatePositionDisplay();
  
        //for (let i = 0; i < 10; i++)
        //timeTracker.append(document.createElement("br"));
  
  
        // Function to update the position display
        function updatePositionDisplay() {
            positionDisplay.innerHTML = "<b>Time:</b> " + toTime(audio.currentTime) + "<br>";
            timeSlider.value = audio.duration ? audio.currentTime / audio.duration : 0;
        }
  
        // Function to change the time of the audio
        function changeTime() {
            positionDisplay.innerHTML = "<b>Time:</b> " + toTime(audio.currentTime) + "<br>";
            audio.currentTime = timeSlider.value * audio.duration;
        }
  
        updateVolume = event => {
            audio.volume = event.target.value;
        }
  
        // Update the position display and slider every second
        setInterval(updatePositionDisplay, 1000);
  
        // Listen for changes to the time slider and change the time of the audio
        timeSlider.addEventListener("input", changeTime);
        volumeSlider.addEventListener("input", updateVolume)
    }
  
    function newMusicPlayer() {
        trackSel = document.createElement("div");
        trackSel.id = "trackSelParent"
        let z = `<br><br><br><br><br><br><br><br><br><br><div id='trackSel' style="text-align:left;border-style:solid;border-width:3px;overflow-y: hidden;overflow-x: hidden;height:200px; width:400px;background-color:#999999;float:right;">`
        z += `<b><select id='selectSoundtrack'><option value='` + soundtracks[e.selectedSoundtrack].name + `'>` + soundtracks[e.selectedSoundtrack].name + "</option>"
        for (i in soundtracks) {
            if (soundtracks[e.selectedSoundtrack] != soundtracks[i]) {
                z += `<option value='` + soundtracks[i].name + `'>` + soundtracks[i].name + `</option>`
            }
        }
        z += `</select></b><br><br>`
            // <label><input type="radio" name="option" value="option1">Option 1</label><br>
        for (i in soundtracks[e.selectedSoundtrack].tracklist) {
            let a = soundtracks[e.selectedSoundtrack].tracklist[i]
            let b = `<label><input class="trackSelector" type="radio" name="trackSelector" value="` + i + `">` + a.name + `</label><br>`
            z += b
        }
        z += "</div><br><br>"
        trackSel.innerHTML = z
  
        // select correct song
  
        musicBox.appendChild(trackSel);
        Array.from(document.getElementById("trackSel").children).filter(f => {
            return f.tagName == "LABEL"
        }).map(f => f.children[0])[0].checked = true
  
        // set soundtrack changer
  
        soundtrackSelector = document.getElementById("selectSoundtrack")
        soundtrackSelector.onchange = function() {
            for (i in soundtracks) {
                if (soundtracks[i].name == soundtrackSelector.value) {
                    e.selectedSoundtrack = i
                    break
                }
            }
            document.getElementById("trackSelParent").remove()
            newMusicPlayer()
        }
  
        var matches = document.querySelectorAll('.trackSelector');
  
        for (match in matches) {
            matches[match].onchange = function() {
                audio = $("#campaigntrailmusic")[0];
                audio.src = soundtracks[e.selectedSoundtrack].tracklist[this.value].url
                audio.currentTime = 0
            }
        }
  
        musicBox.children[2].loop = false
        musicBox.children[2].src = soundtracks[e.selectedSoundtrack].tracklist[0].url
  
        musicBox.children[2].onended = function() {
            console.log("next track")
            let selected = Number(document.querySelector('input[name="trackSelector"]:checked').value);
            let newSel = clamp(selected + 1, soundtracks[e.selectedSoundtrack].tracklist.length - 1, 0)
            let buttons = Array.from(document.getElementById("trackSel").children).filter(f => {
                    return f.tagName == "LABEL"
                }).map(f => f.children[0])
                //let selectedIndex = buttons.map(f=>f.children[0]).map(f=>f.checked)
            buttons[newSel].click()
        }
  
        for (w = 0; w < 7; w++) {
            document.getElementById("trackSelParent").appendChild(document.createElement("br"))
        }
  
        generateTime();
    }
  
    clamp = function(a, max, min, overflow = true) {
        if (overflow) {
            return a > max ? min : a < min ? max : a;
        }
        return a > max ? max : a < min ? min : a;
    }
  
  
    // Track list
  
    var soundtracks = {
        0: {
            name: "Kasich\'s Pop/Rock",
            tracklist: [
			  {
                "name": "Seven Nation Army - The White Stripes",
                "url": "https://audio.jukehost.co.uk/aSD4PBguAtxA2vx3cqTVBh7LBoRQ9NxC"
              },
			  {
                "name": "Pompeii - Bastille",
                "url": "https://audio.jukehost.co.uk/6hsJ8HzqQh43FtbSUNqDvSWmJjZ7yeDb"
              },
			  {
                "name": "Beautiful Day - U2",
                "url": "https://audio.jukehost.co.uk/0Tzbk8LTMiKHpmA6pZ6CjNtrAQxJEJF1"
              },
			  {
                "name": "This Town - O.A.R.",
                "url": "https://audio.jukehost.co.uk/4m3I3nAAwZjkISfSCRknblhIbSC9XHiL"
              },
			  {
                "name": "Thunderstruck - AC/DC",
                "url": "https://audio.jukehost.co.uk/7Vza3hN4Ql3a8QMKt23051iltTTM0Awf"
              },
			  {
                "name": "Money - Pink Floyd",
                "url": "https://audio.jukehost.co.uk/6S3nA7yRbbpKNKE6EAtLsSxVhg90WfMD"
              }
          ]
        }
    }
  
    // Set up new music player
	if (!hasMusic) {
		newMusicPlayer()
		hasMusic = true;
	}
  }